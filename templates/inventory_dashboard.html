{% extends 'base.html' %}
{% load tz %}

{% block title %}Inventory Dashboard - NeuroStock{% endblock %}

{% block nav %}
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-brain me-2"></i>NeuroStock
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'inventory_dashboard' %}">
                            <i class="fas fa-warehouse me-1"></i>Inventory
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'billing' %}">
                            <i class="fas fa-receipt me-1"></i>Billing
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown me-3">
                        <a class="nav-link position-relative" href="#" id="notificationDropdown" role="button" 
                           onclick="showNotifications()">
                            <i class="fas fa-bell"></i>
                            {% if total_notifications > 0 %}
                            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                                {{ total_notifications }}
                            </span>
                            {% endif %}
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user me-1"></i>{{ user.username }}
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{% url 'logout' %}">
                                <i class="fas fa-sign-out-alt me-1"></i>Logout
                            </a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
{% endblock %}

{% block content %}
<!-- Header -->
<div class="row mb-4">
    <div class="col-12">
        <div>
            <h2 class="mb-1">Inventory Management</h2>
            <p class="text-muted mb-0">Manage products and stock entries</p>
        </div>
    </div>
</div>

<!-- Notifications Panel - Always Visible -->
<div class="row mb-4" id="notifications-panel">
    <div class="col-12">
        <div class="card shadow-lg border-primary">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-bell me-2"></i>Notifications
                    {% if total_notifications > 0 %}
                        <span class="badge bg-light text-primary ms-2">{{ total_notifications }} New</span>
                    {% endif %}
                    {% if read_notifications %}
                        <span class="badge bg-secondary ms-2">{{ read_notifications|length }} Read</span>
                    {% endif %}
                </h5>
            </div>
            <div class="card-body">
                <!-- Tabs for New and History -->
                <ul class="nav nav-tabs mb-3" id="notificationTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="new-tab" data-bs-toggle="tab" data-bs-target="#new-notifications" type="button" role="tab">
                            <i class="fas fa-bell me-1"></i>New Notifications ({{ total_notifications }})
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="history-tab" data-bs-toggle="tab" data-bs-target="#notification-history" type="button" role="tab">
                            <i class="fas fa-history me-1"></i>History ({{ read_notifications|length }})
                        </button>
                    </li>
                </ul>
                
                <div class="tab-content" id="notificationTabContent">
                    <!-- New Notifications Tab -->
                    <div class="tab-pane fade show active" id="new-notifications" role="tabpanel">
                        {% if notifications %}
                            {% for notification in notifications %}
                            <div class="notification-item priority-{{ notification.priority }} mb-3 p-3 border rounded 
                                 {% if notification.priority == 'urgent' %}border-danger bg-danger-subtle
                                 {% elif notification.priority == 'high' %}border-warning bg-warning-subtle
                                 {% elif notification.priority == 'medium' %}border-info bg-info-subtle
                                 {% else %}border-secondary bg-light{% endif %}" data-notification-id="{{ notification.id }}">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div class="flex-grow-1">
                                        <h6 class="mb-1 
                                            {% if notification.priority == 'urgent' %}text-danger
                                            {% elif notification.priority == 'high' %}text-warning
                                            {% elif notification.priority == 'medium' %}text-info
                                            {% else %}text-primary{% endif %}">
                                            {% if notification.priority == 'urgent' %}
                                                <i class="fas fa-fire me-1"></i>
                                            {% elif notification.priority == 'high' %}
                                                <i class="fas fa-exclamation-triangle me-1"></i>
                                            {% elif notification.priority == 'medium' %}
                                                <i class="fas fa-info-circle me-1"></i>
                                            {% else %}
                                                <i class="fas fa-bell me-1"></i>
                                            {% endif %}
                                            {{ notification.title }}
                                            <span class="badge ms-2 
                                                {% if notification.priority == 'urgent' %}bg-danger
                                                {% elif notification.priority == 'high' %}bg-warning text-dark
                                                {% elif notification.priority == 'medium' %}bg-info
                                                {% else %}bg-secondary{% endif %}">
                                                {{ notification.priority|upper }}
                                            </span>
                                        </h6>
                                        <p class="mb-2 text-muted">{{ notification.message|linebreaks }}</p>
                                        {% if notification.product %}
                                        <div class="small text-info">
                                            <i class="fas fa-box me-1"></i>{{ notification.product.name }}
                                            <span class="ms-2 text-muted">Stock: {{ notification.product.total_stock }} units</span>
                                        </div>
                                        {% endif %}
                                        <div class="small text-muted mt-2">
                                            <i class="fas fa-clock me-1"></i>Sent: <span class="notification-time" data-created-time="{{ notification.created_at|date:'c' }}">{% timezone "Asia/Kolkata" %}{{ notification.created_at|date:"M d, Y H:i" }}{% endtimezone %}</span>
                                        </div>
                                    </div>
                                    <div class="text-end">
                                        <button class="btn btn-sm btn-success mark-read-btn" data-notification-id="{{ notification.id }}" title="Mark as read">
                                            <i class="fas fa-check"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="text-center py-4">
                                <i class="fas fa-bell-slash fa-3x text-muted mb-3"></i>
                                <h5 class="text-muted">No new notifications</h5>
                                <p class="text-muted">You're all caught up!</p>
                            </div>
                        {% endif %}
                    </div>
                    
                    <!-- Notification History Tab -->
                    <div class="tab-pane fade" id="notification-history" role="tabpanel">
                        {% if read_notifications %}
                            {% for notification in read_notifications %}
                            <div class="notification-item-read mb-3 p-3 border rounded 
                                 {% if notification.priority == 'urgent' %}border-danger bg-danger-subtle
                                 {% elif notification.priority == 'high' %}border-warning bg-warning-subtle
                                 {% elif notification.priority == 'medium' %}border-info bg-info-subtle
                                 {% else %}border-secondary bg-light{% endif %}">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div class="flex-grow-1">
                                        <h6 class="mb-1 text-muted">
                                            <i class="fas fa-check-circle text-success me-1"></i>
                                            {{ notification.title }}
                                            <span class="badge ms-2 
                                                {% if notification.priority == 'urgent' %}bg-danger
                                                {% elif notification.priority == 'high' %}bg-warning text-dark
                                                {% elif notification.priority == 'medium' %}bg-info
                                                {% else %}bg-secondary{% endif %}">
                                                {{ notification.priority|upper }}
                                            </span>
                                        </h6>
                                        <p class="mb-2 text-muted small">{{ notification.message|linebreaks }}</p>
                                        {% if notification.product %}
                                        <div class="small text-info">
                                            <i class="fas fa-box me-1"></i>{{ notification.product.name }}
                                        </div>
                                        {% endif %}
                                        <div class="small text-muted mt-2">
                                            <i class="fas fa-clock me-1"></i>Sent: <span class="notification-received-time" data-created-time="{{ notification.created_at|date:'c' }}">{% timezone "Asia/Kolkata" %}{{ notification.created_at|date:"M d, Y H:i" }}{% endtimezone %}</span>
                                            <span class="ms-3"><i class="fas fa-check me-1"></i>Read: <span class="notification-read-time" data-read-time="{{ notification.safe_updated_at|date:'c' }}">{% timezone "Asia/Kolkata" %}{{ notification.safe_updated_at|date:"M d, Y H:i" }}{% endtimezone %}</span></span>
                                        </div>
                                    </div>
                                    <div class="text-end">
                                        <span class="badge bg-success">Read</span>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="text-center py-4">
                                <i class="fas fa-history fa-3x text-muted mb-3"></i>
                                <h5 class="text-muted">No notification history</h5>
                                <p class="text-muted">Read notifications will appear here</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Forms Row -->
<div class="row mb-4">
    <div class="col-lg-6 mb-3">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-plus me-2"></i>Add Product</h5>
            </div>
            <div class="card-body">
                <form method="post">
                    {% csrf_token %}
                    <div class="mb-3">
                        {{ product_form.name.label_tag }}
                        {{ product_form.name }}
                    </div>
                    <div class="mb-3">
                        {{ product_form.category.label_tag }}
                        {{ product_form.category }}
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            {{ product_form.cost_price.label_tag }}
                            {{ product_form.cost_price }}
                        </div>
                        <div class="col-md-6 mb-3">
                            {{ product_form.selling_price.label_tag }}
                            {{ product_form.selling_price }}
                        </div>
                    </div>
                    <button type="submit" name="add_product" class="btn btn-primary">
                        <i class="fas fa-plus me-1"></i>Add Product
                    </button>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-lg-6 mb-3">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-boxes me-2"></i>Add Stock</h5>
            </div>
            <div class="card-body">
                <form method="post">
                    {% csrf_token %}
                    <div class="mb-3">
                        {{ stock_form.product.label_tag }}
                        {{ stock_form.product }}
                    </div>
                    <div class="mb-3">
                        {{ stock_form.quantity.label_tag }}
                        {{ stock_form.quantity }}
                    </div>
                    <div class="mb-3">
                        {{ stock_form.expiry_date.label_tag }}
                        {{ stock_form.expiry_date }}
                    </div>
                    <button type="submit" name="add_stock" class="btn btn-success">
                        <i class="fas fa-plus me-1"></i>Add Stock
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Products Table -->
<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-list me-2"></i>Products Overview</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table" id="products-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Category</th>
                                <th>Cost Price</th>
                                <th>Selling Price</th>
                                <th>Current Price</th>
                                <th>Class</th>
                                <th>Stock</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for product in products %}
                            <tr data-product-id="{{ product.id }}">
                                <td><strong>{{ product.name }}</strong></td>
                                <td>{{ product.category }}</td>
                                <td>‚Çπ{{ product.cost_price }}</td>
                                <td>‚Çπ{{ product.selling_price }}</td>
                                <td><strong>‚Çπ{{ product.new_price }}</strong></td>
                                <td>
                                    <span class="badge bg-{% if product.calculated_abc_classification == 'A' %}danger{% elif product.calculated_abc_classification == 'B' %}warning{% else %}secondary{% endif %}">
                                        {{ product.calculated_abc_classification }}
                                    </span>
                                </td>
                                <td>{{ product.total_stock }}</td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="7" class="text-center text-muted">No products available</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Recent Stock Entries -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-history me-2"></i>Recent Stock Entries</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Quantity</th>
                                <th>Expiry Date</th>
                                <th>Added On</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for stock in recent_stock %}
                            <tr>
                                <td>{{ stock.product.name }}</td>
                                <td>{{ stock.quantity }} units</td>
                                <td>{{ stock.expiry_date }}</td>
                                <td>{% timezone "Asia/Kolkata" %}{{ stock.created_at|date:"M d, Y" }}{% endtimezone %}</td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="4" class="text-center text-muted">No recent stock entries</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Real-time clock for inventory
function updateInventoryTime() {
    const now = new Date();
    const timeString = now.toLocaleTimeString('en-US', {
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: true
    });
    
    const currentTimeElement = document.getElementById('current-time-inventory');
    if (currentTimeElement) {
        currentTimeElement.textContent = timeString;
    }
}

// Initialize inventory time updates
document.addEventListener('DOMContentLoaded', function() {
    updateInventoryTime();
    setInterval(updateInventoryTime, 1000);
});

// Notification System JavaScript - Isolated and Clean
(function() {
    'use strict';
    
    console.log('üöÄ Initializing notification system...');
    
    // Global functions for template usage
    window.showNotifications = function() {
        console.log('üîî Bell icon clicked');
        const panel = document.getElementById('notifications-panel');
        if (panel) {
            panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    };
    
    // Initialize notification buttons when DOM is ready
    function initializeNotificationButtons() {
        console.log('üìÑ Initializing notification buttons...');
        
        const markReadButtons = document.querySelectorAll('.mark-read-btn');
        console.log(`üîç Found ${markReadButtons.length} mark-read buttons`);
        
        markReadButtons.forEach(function(button, index) {
            // Remove any existing listeners to prevent duplicates
            const newButton = button.cloneNode(true);
            button.parentNode.replaceChild(newButton, button);
            
            console.log(`üîß Setting up button ${index + 1}`);
            
            newButton.addEventListener('click', function(event) {
                event.preventDefault();
                event.stopPropagation();
                
                console.log('‚úÖ Mark as read button clicked!');
                
                const notificationId = this.getAttribute('data-notification-id');
                console.log('üìù Notification ID:', notificationId);
                
                if (!notificationId) {
                    alert('Error: No notification ID found');
                    return;
                }
                
                // Get CSRF token
                const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]');
                if (!csrfToken) {
                    alert('Error: CSRF token not found. Please refresh the page.');
                    return;
                }
                
                console.log('üîê CSRF token found');
                
                // Show loading state
                const originalHTML = this.innerHTML;
                this.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                this.disabled = true;
                
                console.log('üì° Sending AJAX request...');
                
                // Create form data
                const formData = new FormData();
                formData.append('csrfmiddlewaretoken', csrfToken.value);
                formData.append('notification_id', notificationId);
                
                // Send AJAX request
                fetch('/inventory/', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                })
                .then(response => {
                    console.log('üì® Response status:', response.status);
                    return response.json();
                })
                .then(data => {
                    console.log('üìä Response data:', data);
                    
                    if (data.success) {
                        console.log('‚úÖ Success! Moving notification to history...');
                        
                        // Find the notification item
                        const notificationItem = this.closest('.notification-item');
                        if (notificationItem) {
                            // Get notification data before removing
                            const notificationData = {
                                id: notificationId,
                                title: notificationItem.querySelector('h6').textContent,
                                message: notificationItem.querySelector('p').textContent,
                                sentTime: notificationItem.querySelector('.notification-time').textContent.replace('Sent: ', ''),
                                priority: notificationItem.classList.contains('priority-urgent') ? 'urgent' :
                                         notificationItem.classList.contains('priority-high') ? 'high' :
                                         notificationItem.classList.contains('priority-medium') ? 'medium' : 'low'
                            };
                            
                            // Smooth fade out animation
                            notificationItem.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                            notificationItem.style.opacity = '0';
                            notificationItem.style.transform = 'translateX(100%)';
                            
                            setTimeout(() => {
                                // Remove from new notifications
                                notificationItem.remove();
                                
                                // Add to history tab
                                addToNotificationHistory(notificationData);
                                
                                // Update notification badge count
                                updateNotificationBadge();
                                
                                // Show success message
                                showSuccessMessage('‚úÖ Notification moved to history!');
                                
                            }, 500);
                        }
                    } else {
                        console.error('‚ùå Server error:', data.error);
                        alert('Error: ' + (data.error || 'Failed to mark as read'));
                        
                        // Restore button state
                        this.innerHTML = originalHTML;
                        this.disabled = false;
                    }
                })
                .catch(error => {
                    console.error('‚ùå Network error:', error);
                    alert('Network error. Please check your connection and try again.');
                    
                    // Restore button state
                    this.innerHTML = originalHTML;
                    this.disabled = false;
                });
            });
        });
        
        console.log('‚úÖ All notification buttons initialized!');
    }
    
    // Helper function to add notification to history tab
    function addToNotificationHistory(notificationData) {
        const historyTab = document.querySelector('#notification-history');
        if (historyTab) {
            // Get current IST time
            const now = new Date();
            const istTime = new Date(now.getTime() + (5.5 * 60 * 60 * 1000)); // Add 5.5 hours for IST
            const currentTime = istTime.toLocaleString('en-US', {
                month: 'short',
                day: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                hour12: false,
                timeZone: 'Asia/Kolkata'
            });
            
            // Create history item HTML with priority colors
            const priorityClasses = {
                'urgent': 'border-danger bg-danger-subtle',
                'high': 'border-warning bg-warning-subtle', 
                'medium': 'border-info bg-info-subtle',
                'low': 'border-secondary bg-light'
            };
            
            const priorityBadges = {
                'urgent': 'bg-danger',
                'high': 'bg-warning text-dark',
                'medium': 'bg-info',
                'low': 'bg-secondary'
            };
            
            const historyItem = document.createElement('div');
            historyItem.className = `notification-item-read mb-3 p-3 border rounded ${priorityClasses[notificationData.priority] || 'border-secondary bg-light'}`;
            historyItem.innerHTML = `
                <div class="d-flex justify-content-between align-items-start">
                    <div class="flex-grow-1">
                        <h6 class="mb-1 text-muted">
                            <i class="fas fa-check-circle text-success me-1"></i>${notificationData.title}
                            <span class="badge ms-2 ${priorityBadges[notificationData.priority] || 'bg-secondary'}">
                                ${notificationData.priority.toUpperCase()}
                            </span>
                        </h6>
                        <p class="mb-2 text-muted small">${notificationData.message}</p>
                        <div class="small text-muted mt-2">
                            <i class="fas fa-clock me-1"></i>Sent: ${notificationData.sentTime}
                            <span class="ms-3"><i class="fas fa-check me-1"></i>Read: ${currentTime}</span>
                        </div>
                    </div>
                    <div class="text-end">
                        <span class="badge bg-success">Read</span>
                    </div>
                </div>
            `;
            
            // Add to top of history tab
            const existingItems = historyTab.querySelectorAll('.notification-item-read');
            if (existingItems.length > 0) {
                historyTab.insertBefore(historyItem, existingItems[0]);
            } else {
                // Replace the "no history" message
                const noHistoryMsg = historyTab.querySelector('.text-center.py-4');
                if (noHistoryMsg) {
                    noHistoryMsg.remove();
                }
                historyTab.appendChild(historyItem);
            }
            
            // Update history tab count
            const historyTabButton = document.querySelector('#history-tab');
            if (historyTabButton) {
                const currentHistoryCount = historyTab.querySelectorAll('.notification-item-read').length;
                historyTabButton.innerHTML = `<i class="fas fa-history me-1"></i>History (${currentHistoryCount})`;
            }
        }
    }
    
    // Helper function to update notification badge
    function updateNotificationBadge() {
        const badge = document.querySelector('.position-absolute.badge.bg-danger');
        const newTab = document.querySelector('#new-tab');
        
        // Count visible notifications in new tab
        const visibleNotifications = document.querySelectorAll('#new-notifications .notification-item:not([style*="display: none"])').length;
        
        if (badge) {
            if (visibleNotifications > 0) {
                badge.textContent = visibleNotifications;
                badge.style.display = 'block';
            } else {
                badge.style.display = 'none';
            }
        }
        
        // Update new tab count
        if (newTab) {
            newTab.innerHTML = `<i class="fas fa-bell me-1"></i>New Notifications (${visibleNotifications})`;
        }
        
        // Show "no notifications" message if needed
        if (visibleNotifications === 0) {
            const newNotificationsTab = document.querySelector('#new-notifications');
            if (newNotificationsTab && !newNotificationsTab.querySelector('.text-center.py-4')) {
                newNotificationsTab.innerHTML = `
                    <div class="text-center py-4">
                        <i class="fas fa-bell-slash fa-3x text-muted mb-3"></i>
                        <h5 class="text-muted">No new notifications</h5>
                        <p class="text-muted">You're all caught up!</p>
                    </div>
                `;
            }
        }
    }
    
    // Helper function to show success message
    function showSuccessMessage(message) {
        // Create a temporary success alert
        const alertDiv = document.createElement('div');
        alertDiv.className = 'alert alert-success alert-dismissible fade show position-fixed';
        alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
        alertDiv.innerHTML = `
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        
        document.body.appendChild(alertDiv);
        
        // Auto-remove after 3 seconds
        setTimeout(() => {
            if (alertDiv.parentNode) {
                alertDiv.remove();
            }
        }, 3000);
    }
    
    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeNotificationButtons);
    } else {
        initializeNotificationButtons();
    }
    
    console.log('üìú Notification system script loaded successfully');
})();
</script>

<style>
/* Notification styling with priority colors */
.notification-item {
    transition: all 0.3s ease;
    border-left: 4px solid #007bff;
}

.notification-item.priority-urgent {
    border-left-color: #dc3545;
    box-shadow: 0 2px 8px rgba(220, 53, 69, 0.2);
}

.notification-item.priority-urgent:hover {
    box-shadow: 0 4px 12px rgba(220, 53, 69, 0.3);
}

.notification-item.priority-high {
    border-left-color: #fd7e14;
    box-shadow: 0 2px 8px rgba(253, 126, 20, 0.2);
}

.notification-item.priority-high:hover {
    box-shadow: 0 4px 12px rgba(253, 126, 20, 0.3);
}

.notification-item.priority-medium {
    border-left-color: #0dcaf0;
    box-shadow: 0 2px 8px rgba(13, 202, 240, 0.2);
}

.notification-item.priority-medium:hover {
    box-shadow: 0 4px 12px rgba(13, 202, 240, 0.3);
}

.notification-item.priority-low {
    border-left-color: #6c757d;
}

.notification-item:hover {
    transform: translateY(-2px);
}

/* Priority badge animations */
.badge {
    animation: pulse-priority 2s infinite;
}

@keyframes pulse-priority {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

/* Urgent notifications get special attention */
.notification-item.priority-urgent .badge {
    animation: urgent-blink 1.5s infinite;
}

@keyframes urgent-blink {
    0%, 50% { opacity: 1; }
    25%, 75% { opacity: 0.7; }
}

.nav-link .badge {
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

/* Mark as read button styling */
.mark-read-btn {
    transition: all 0.2s ease;
    position: relative;
}

.mark-read-btn:hover {
    transform: scale(1.1);
}

.mark-read-btn:disabled {
    opacity: 0.6;
    transform: none;
}

/* Success message styling */
.alert.position-fixed {
    animation: slideInRight 0.3s ease-out;
}

@keyframes slideInRight {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}
</style>
{% endblock %}